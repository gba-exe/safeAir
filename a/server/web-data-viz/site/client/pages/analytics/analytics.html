<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="icon" href="../../assets/logoClaro.jpeg" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="analytics.css">
    <link rel="stylesheet" href="../../style/style.css" />
    <link rel="stylesheet" href="../navbarFooter/navbarDashboard.css">
    <title>Analytics</title>
</head>

<body>
    <script src="../../assets/components/headerDashboard.js"></script>
    <div id="divDashboard">
        <div class="divContent">

            <div class="divLogo">
                <img src="../../assets/logos/logoSemFundoMaior.png">
            </div>

            <div class="divMetricas">
                <div class="divMetricaEspecifica">
                    <h1>Métricas utilizadas para temperatura</h1>
                    <img src="../../assets/analyticsTemperatura.png" alt="">
                </div>
                <div class="divMetricaEspecifica">
                    <h1>Métricas utilizadas para umidade</h1>
                    <img src="../../assets/analyticsUmidade.png" alt="">
                </div>
            </div>

            <div class="divSelect">
                <select id="selectEndereco" onchange="plotarGrafico()">
                </select>
                <select id="selectSala" onchange="plotarGrafico()">
                </select>
            </div>

            <div class="divGraficosGeral">
                <h1>Desde o começo do nosso processo, a sala Diretória esteve nos seguindes estados:</h1>
                <div class="divTodosGraficos">
                    <div class="divGrafico">
                        <div class="divTemperaturaGrafico">
                            <canvas style="width : 100%;" id="rosquinhaTemperatura"></canvas>
                        </div>
                        <div class="divLegenda">
                            <label for="">
                                <img src="../../assets/bolinhaVerde.png" alt="">
                                <p>55% Ideal</p>
                            </label>
                            <label for="">
                                <img src="../../assets/bolinhaAmarela.png" alt="">
                                <p>15% Alerta</p>
                            </label>
                            <label for="">
                                <img src="../../assets/bolinhaLaranja.png" alt="">
                                <p> 15% Emergência</p>
                            </label>
                            <label for="">
                                <img src="../../assets/bolinhaVermelha.png" alt="">
                                <p>15% Crítico</p>
                            </label>
                        </div>
                    </div>
                    <div class="divGrafico">
                        <div class="divUmidadeGrafico">
                            <canvas style="width : 100%;" id="rosquinhaUmidade"></canvas>
                        </div>
                        <div class="divLegenda">
                            <label for="">
                                <img src="../../assets/bolinhaVerde.png" alt="">
                                <p>55% Ideal</p>
                            </label>
                            <label for="">
                                <img src="../../assets/bolinhaAmarela.png" alt="">
                                <p>15% Alerta</p>
                            </label>
                            <label for="">
                                <img src="../../assets/bolinhaLaranja.png" alt="">
                                <p> 15% Emergência</p>
                            </label>
                            <label for="">
                                <img src="../../assets/bolinhaVermelha.png" alt="">
                                <p>15% Crítico</p>
                            </label>
                        </div>
                    </div>
                </div>
                <div id="divRegistros">
                    <div class="divRegistroTempUmi">
                        <h1>Registro de Temperatura</h1>
                        <div class="divDados">
                            <div class="data">
                                <h1>DATA:</h1>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                            </div>
                            <div class="data">
                            </div>
                            <div class="data">
                                <h1>DADOS:</h1>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                            </div>
                        </div>
                    </div>
                    <div class="divRegistroTempUmi">
                        <h1>Registro de Umidade</h1>
                        <div class="divDados">
                            <div class="data">
                                <h1>DATA:</h1>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                                <p>01/04/2023</p>
                            </div>
                            <div class="data">
                            </div>
                            <div class="data">
                                <h1>DADOS:</h1>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                                <p>80%</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="analytics.js"></script>
<script>


    const rosquinha = document.getElementById('rosquinhaTemperatura');


    var fkEmpresa = sessionStorage.EMPRESA_USUARIO

    new Chart(rosquinha, {
        type: 'doughnut',
        data: {
            datasets: [{
                data: ['55', '15', '15', '15'],
                backgroundColor: [
                    'rgb(101,163,13)', 'rgb(207,188,15)', 'rgb(207,119,15)', 'rgb(194,65,12)'
                ],
                borderColor: [
                    'rgb(101,163,13)', 'rgb(207,188,15)', 'rgb(207,119,15)', 'rgb(194,65,12)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            cutoutPercentage: 100,
            plugins: {
                legend: {
                    labels: {
                        font: {
                            size: 18
                        }
                    }
                }
            }

        }
    });

    const rosquinha1 = document.getElementById('rosquinhaUmidade');
    new Chart(rosquinha1, {
        type: 'doughnut',
        data: {
            datasets: [{
                data: ['55', '15', '15', '15'],
                backgroundColor: [
                    'rgb(101,163,13)', 'rgb(207,188,15)', 'rgb(207,119,15)', 'rgb(194,65,12)'
                ],
                borderColor: [
                    'rgb(101,163,13)', 'rgb(207,188,15)', 'rgb(207,119,15)', 'rgb(194,65,12)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            cutoutPercentage: 100,
            plugins: {
                legend: {
                    labels: {
                        font: {
                            size: 18
                        }
                    }
                }
            }

        }
    });

    var vtCaptura = [];
    var vtSalas = [];
    var vtId = [];
    var fkEmpresaVar = fkEmpresa;


    captarSalas();
    function captarSalas() {
        if (fkEmpresaVar == '') {
            alert('Não encontrei esta uma empresa com este id');
            return false;
        }
        else {
            console.log("idEmpresa: ", fkEmpresaVar);

            fetch("/usuarios/captarSalas", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    fkEmpresaServer: fkEmpresaVar
                })
            }).then(function (resposta) {
                console.log("ESTOU NO THEN DO captarSalas()!")

                if (resposta.ok) {
                    console.log(resposta);

                    resposta.json().then(json => {
                        console.log(json);
                        console.log(JSON.stringify(json));

                        vtCaptura = json;
                        console.log(vtCaptura.length)

                        for (let i = 0; i < vtCaptura.length; i++) {
                            let pushNome = vtCaptura[i].nomeSala;
                            let pushId = vtCaptura[i].idSala;
                            vtSalas.push(pushNome);
                            vtId.push(pushId);
                        }
                        console.log(vtSalas.length)
                        for (let i = 0; i < vtSalas.length; i++) {
                            alert('foi' + i);
                            selectSala.innerHTML += `<option value='${vtId[i]}'>${vtSalas[i]}</option>`
                        }

                        plotarGrafico()
                    });

                } else {
                    alert("A captura não funcionou")
                    console.log("Houve um erro ao tentar realizar a captura");
                }

            }).catch(function (erro) {
                console.log(erro);
            })
        }
    }

    // function plotarGrafico() {

    //     var idSalaVar = selectSala.value;
    //     var fkEmpresaVar = fkEmpresa;
    //     var fkEnderecoVar = 1;


    //     if (fkEmpresaVar == '') {
    //         alert('Não encontrei esta uma empresa com este id');
    //         return false;
    //     }
    //     else {

    //         console.log("idEmpresa: ", fkEmpresaVar);

    //         fetch("/usuarios/captarSalas", {
    //             method: "POST",
    //             headers: {
    //                 "Content-Type": "application/json"
    //             },
    //             body: JSON.stringify({
    //                 fkEmpresaServer: fkEmpresaVar
    //             })
    //         }).then(function (resposta) {
    //             console.log("ESTOU NO THEN DO captarSalas()!")

    //             if (resposta.ok) {
    //                 console.log(resposta);

    //                 resposta.json().then(json => {
    //                     console.log(json);
    //                     console.log(JSON.stringify(json));

    //                     vtCaptura = json;
    //                     console.log(vtCaptura.length)

    //                     for (let i = 0; i < vtCaptura.length; i++) {
    //                         let pushNome = vtCaptura[i].nomeSala;
    //                         let pushId = vtCaptura[i].idSala;
    //                         vtSalas.push(pushNome);
    //                         vtId.push(pushId);
    //                     }

    //                     for (let i = 0; i < vtSalas.length; i++) {
    //                         selectSala.innerHTML += `<option value='${vtId[i]}'>${vtSalas[i]}</option>`
    //                     }

    //                     plotarGrafico()
    //                 });

    //             } else {
    //                 alert("A captura não funcionou")
    //                 console.log("Houve um erro ao tentar realizar a captura");
    //             }

    //         }).catch(function (erro) {
    //             console.log(erro);
    //         })
    //     }
    // }
</script>